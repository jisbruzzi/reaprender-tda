---
title: Flujo en redes
módulos:
  - 7.1
  - 7.2
  - 7.3
  - 7.5
  - 7.6
  - 7.8
  - (7.9)
  - 7.10
---
# The Maximum-Flow Problem and the Ford-Fulkerson Algorithm

## Flow network
Digrafo $G=(V,E)$ en el cual:
- Cada arista $e$ (edge) tiene una capacidad $c_e$
- Hay un vértice fuente (source) $s \in V$
- Hay un vértice escape (sink o target) $t \in V$

## Flow
Un flujo (flow) es una función $f:E \to \mathbb{R}^+$ que indica cuánto flujo $f(e)$ pasa por cada arista $e$. Satisface:
- Capacidad: $0\leq f(e)\leq c_e \forall e\in E$
- Conservación: $\sum_{e\in v_{in}} f(e) = \sum_{e\in v_{out}} f(e)$, donde $v_{in} \subset E$ son las aristas entrantes de $v$ y $v_{out}\subset E$ son las salientes de $v$. También puede enunciarse $f^{in}(v)=f^{out}(v) \forall v\in V-\{s,t\}$

Los vértices sink y source no cumplen la regla de la conservación.

## Valor de un flujo

$$v(f)=\sum_{e\in s_{out}} f(e)$$

La suma del flujo saliente de la fuente.

$$v(f)=f^{out}(s)=f^{in}(t)$$

## Problema del flujo máximo

Dada una red de flujo, encontrar un $f$ que maximice $v(f)$.
## Arista inversa
Una función que invierte una arista:
$$\operatorname{rev}((u,v))=(v,u)$$

## Grafo residual (residual graph)

Dada una red $G$ y un flujo $f$, $G_f=(V_f,E_f)$ con capacidades $c^f_e$ es el grafo residual. Cumple:
- Los mismos vértices: $V_f=V$
- Las aristas originales ahora tienen capacidad residual: $c^f_e=c_e-f(e)$
- Se agregan aristas inversas cuya capacidad es el flujo de la original:
  - $E´_f=\{\operatorname{rev}(e)\forall e\in E:f(e)>0\}$
  - $E_f=E \cup E´_f$. 
  - $c_{e´}^{f}=f(\operatorname{rev}(e´)) \forall e´\in E´_f$


## Función `bottleneck`
Sea $P$ un camino entre $s$ y $t$ en $G_f$.
$$
\operatorname{bottleneck}(P,f)=\min_{e\in P} (c_e^f)
$$

Es decir, es la mínima capacidad residual en $P$: acota cuánto flujo más puedo meter en $P$.

## Operación $\operatorname{augment}$
Recordando que $P$ es un camino por $G_f$, pero que $f$ tiene como domínio las aristas de $G$. La operación $\operatorname{augment}(f,P)$ devuelve un nuevo flujo $f´$ que cumple:
- $f'(e)=f(e)+\operatorname{bottleneck}(P,f)$ si $e\in P$
- $f'(e)=f(e)-\operatorname{bottleneck}(P,f)$ si $rev(e)\in P$
- $f'(e)=f(e)$ de lo contrario

## Algoritmo Ford-Fulkerson

![](res/img/5.ford.fulkerson.algoritmo.png)

## Propiedades del algoritmo FF
DEMOSTRACIONES PENDIENTES

- (7.2) La imagen de $f$ está contenida en $\mathbb{N}$.
- (7.3) $\operatorname{augment}(f,P)=f´ \Rightarrow v(f´)>v(f)$
- (7.4) FF toma como mucho $\sum_{e\in s_{out}}c_e$

